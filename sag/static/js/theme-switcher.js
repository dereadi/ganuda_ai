// SAG Theme Switcher - Generated by IT Jr 2 (V3)
(function() {
    'use strict';
    const THEME_KEY = 'sag-theme-preference';

    function getPreferredTheme() {
        const stored = localStorage.getItem(THEME_KEY);
        if (stored) return stored;
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark';
        }
        return 'light';
    }

    function setTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem(THEME_KEY, theme);
        const btn = document.getElementById('theme-toggle');
        if (btn) {
            btn.textContent = theme === 'dark' ? '‚òÄÔ∏è Light' : 'üåô Dark';
        }
    }

    function toggleTheme() {
        const current = document.documentElement.getAttribute('data-theme') || 'light';
        setTheme(current === 'dark' ? 'light' : 'dark');
    }

    function createToggleButton() {
        const btn = document.createElement('button');
        btn.id = 'theme-toggle';
        btn.onclick = toggleTheme;
        btn.style.cssText = 'position:fixed;top:10px;right:10px;z-index:9999;padding:8px 16px;border:none;border-radius:4px;cursor:pointer;background:var(--sacred-green,#008000);color:white;';
        document.body.appendChild(btn);
    }

    document.addEventListener('DOMContentLoaded', function() {
        setTheme(getPreferredTheme());
        if (!document.getElementById('theme-toggle')) {
            createToggleButton();
        }
    });

    window.SAGTheme = { toggle: toggleTheme, set: setTheme, get: function() { return document.documentElement.getAttribute('data-theme') || 'light'; } };
})();
