# pgAudit configuration for PostgreSQL
# Cherokee AI Federation - Security Phase 3
# Generated: 2026-02-02
#
# Prerequisites (REQUIRES ADMIN):
#   sudo apt-get install postgresql-16-pgaudit
#   -- Then add to postgresql.conf:
#   shared_preload_libraries = 'pgaudit'
#   -- Then deploy this config:
#   sudo cp /ganuda/config/pgaudit.conf /etc/postgresql/16/main/conf.d/pgaudit.conf
#   sudo chown postgres:postgres /etc/postgresql/16/main/conf.d/pgaudit.conf
#   sudo systemctl restart postgresql
#   -- Then enable the extension:
#   sudo -u postgres psql -c "CREATE EXTENSION IF NOT EXISTS pgaudit;"

# Audit read (SELECT), write (INSERT/UPDATE/DELETE), and DDL operations
pgaudit.log = 'read, write, ddl'

# Do not log access to pg_catalog (reduces noise significantly)
pgaudit.log_catalog = off

# Log the object name for every statement (table/view/function)
pgaudit.log_relation = on

# Log query parameters -- critical for forensics
# WARNING: This will include sensitive values in logs.
# Ensure log files have restricted permissions.
pgaudit.log_parameter = on

# Log the statement text along with the audit entry
pgaudit.log_statement_once = off
